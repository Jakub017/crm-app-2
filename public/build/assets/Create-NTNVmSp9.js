import{C as W,g as U,x as z,f as r,o as i,b as j,a as e,w as f,i as c,k as v,e as d,h as x,y as g,u as l,F as y,j as k,t as p,l as u}from"./app-B3HeWcSY.js";import{_ as T}from"./PrimaryButton-BZDaRNHX.js";import{T as $}from"./TopText-kdm_oenm.js";import{_ as N}from"./AppLayout-BGIoYovx.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const D={class:"bg-white rounded-lg p-4 border border-secondary-light"},I={class:"col-span-12"},P=["value"],A={key:0,class:"form-error"},B={class:"col-span-12 md:col-span-6"},K={class:"col-span-12 md:col-span-6"},M={class:"col-span-12 md:col-span-6"},S={key:0,class:"form-error"},E={class:"col-span-12 md:col-span-6"},F={key:0,class:"form-error"},O={class:"col-span-12 md:col-span-4"},G=["onUpdate:modelValue"],L=["value"],H={class:"col-span-12 md:col-span-2"},J=["onUpdate:modelValue"],Q={class:"col-span-12 md:col-span-2"},R=["onUpdate:modelValue"],X={class:"col-span-12 md:col-span-2"},Y=["onUpdate:modelValue"],Z={class:"col-span-12 md:col-span-2"},h=["onUpdate:modelValue"],tt={class:"col-span-12 flex gap-2"},et=["onClick"],st={class:"col-span-12 mt-4"},ot={layout:N},ut=Object.assign(ot,{__name:"Create",props:{clients:Array,today:Date,clientInfo:Object},setup(V){const s=W({buyer_name:"",issue_date:V.today,payment_to:"",buyer_email:"",buyer_tax_no:"",positions:[{name:"",quantity:1,quantity_unit:"szt",net_price:"",tax:23,total_price_gross:""}]}),_=U({}),m=U({});z(()=>s.buyer_name,async n=>{if(n)try{const t=await axios.get(route("task.get",n));_.value=t.data}catch(t){console.log("Wystapil blad podczas pobierania zadan:",t)}else _.value=[]}),z(()=>s.buyer_name,async n=>{if(n)try{const t=await axios.get(route("client.get",n));m.value=t.data,s.buyer_email=m.value.email,s.buyer_tax_no=m.value.tax_no}catch(t){console.log("Wystapil blad podczas pobierania danych klienta:",t)}else m.value=[]});const q=()=>{s.positions.push({name:"",quantity:1,quantity_unit:"szt",net_price:"",tax:23,total_price_gross:""})},b=()=>{s.positions.forEach(n=>{n.total_price_gross=n.quantity*n.net_price*(1+n.tax/100)})},C=()=>s.post(route("invoice.store"));return(n,t)=>(i(),r(y,null,[j($,null,{title:f(()=>t[9]||(t[9]=[c(" Wystaw fakturę ")])),description:f(()=>t[10]||(t[10]=[c(" Wystaw nową fakturę dla swojego klienta. ")])),_:1}),e("div",D,[e("form",{onSubmit:v(C,["prevent"]),class:"grid grid-cols-12 gap-4"},[t[25]||(t[25]=e("div",{class:"col-span-12"},[e("h3",{class:"text-base font-semibold text-gray-900"}," Wybór klienta ")],-1)),e("div",I,[t[12]||(t[12]=e("label",{for:"buyer_name",class:"form-label"},"Klient",-1)),d(e("select",{id:"buyer_name","onUpdate:modelValue":t[0]||(t[0]=o=>l(s).buyer_name=o),class:"form-input",type:"text"},[t[11]||(t[11]=e("option",{value:""},"Wybierz klienta",-1)),(i(!0),r(y,null,k(V.clients,o=>(i(),r("option",{key:o.id,value:o.name},p(o.name),9,P))),128))],512),[[g,l(s).buyer_name]]),l(s).errors.buyer_name?(i(),r("span",A,p(l(s).errors.buyer_name),1)):x("",!0)]),e("div",B,[t[13]||(t[13]=e("label",{for:"buyer_tax_no",class:"form-label"},"NIP",-1)),d(e("input",{id:"buyer_tax_no",class:"form-input",type:"text","onUpdate:modelValue":t[1]||(t[1]=o=>l(s).buyer_tax_no=o)},null,512),[[u,l(s).buyer_tax_no]])]),e("div",K,[t[14]||(t[14]=e("label",{for:"buyer_email",class:"form-label"},"Adres email",-1)),d(e("input",{id:"buyer_email",class:"form-input",type:"text","onUpdate:modelValue":t[2]||(t[2]=o=>l(s).buyer_email=o)},null,512),[[u,l(s).buyer_email]])]),t[26]||(t[26]=e("div",{class:"col-span-12 mt-4"},[e("h3",{class:"text-base font-semibold text-gray-900"}," Dodatkowe informacje ")],-1)),e("div",M,[t[15]||(t[15]=e("label",{for:"issue_date",class:"form-label"},"Data wystawienia",-1)),d(e("input",{id:"issue_date",class:"form-input",type:"date","onUpdate:modelValue":t[3]||(t[3]=o=>l(s).issue_date=o)},null,512),[[u,l(s).issue_date]]),l(s).errors.issue_date?(i(),r("span",S,p(l(s).errors.issue_date),1)):x("",!0)]),e("div",E,[t[16]||(t[16]=e("label",{for:"payment_to",class:"form-label"},"Termin płatności",-1)),d(e("input",{id:"payment_to",class:"form-input",type:"date","onUpdate:modelValue":t[4]||(t[4]=o=>l(s).payment_to=o)},null,512),[[u,l(s).payment_to]]),l(s).errors.payment_to?(i(),r("span",F,p(l(s).errors.payment_to),1)):x("",!0)]),t[27]||(t[27]=e("div",{class:"col-span-12 mt-4"},[e("h3",{class:"text-base font-semibold text-gray-900"}," Pozycje na fakturze ")],-1)),(i(!0),r(y,null,k(l(s).positions,(o,w)=>(i(),r("div",{key:w,class:"col-span-12 grid grid-cols-12 gap-4"},[e("div",O,[t[18]||(t[18]=e("label",{for:"name",class:"form-label"},"Usluga",-1)),d(e("select",{id:"name","onUpdate:modelValue":a=>o.name=a,class:"form-input",type:"text"},[t[17]||(t[17]=e("option",{value:""},"Wybierz zadanie",-1)),(i(!0),r(y,null,k(_.value,a=>(i(),r("option",{key:a.id,value:a.name},p(a.name),9,L))),128))],8,G),[[g,o.name]])]),e("div",H,[t[19]||(t[19]=e("label",{for:"quantity",class:"form-label"},"Ilość",-1)),d(e("input",{id:"quantity",class:"form-input",type:"text","onUpdate:modelValue":a=>o.quantity=a,onChange:t[5]||(t[5]=a=>b())},null,40,J),[[u,o.quantity]])]),e("div",Q,[t[20]||(t[20]=e("label",{for:"net_price",class:"form-label"},"Kwota netto",-1)),d(e("input",{id:"net_price",class:"form-input",type:"text","onUpdate:modelValue":a=>o.net_price=a,onChange:t[6]||(t[6]=a=>b())},null,40,R),[[u,o.net_price]])]),e("div",X,[t[22]||(t[22]=e("label",{for:"tax",class:"form-label"},"VAT",-1)),d(e("select",{id:"tax","onUpdate:modelValue":a=>o.tax=a,class:"form-input",type:"text",onChange:t[7]||(t[7]=a=>b())},t[21]||(t[21]=[e("option",{value:"23"},"23%",-1),e("option",{value:"8"},"8%",-1),e("option",{value:"5"},"5%",-1)]),40,Y),[[g,o.tax]])]),e("div",Z,[t[23]||(t[23]=e("label",{for:"total_price_gross",class:"form-label"},"Kwota brutto",-1)),d(e("input",{id:"total_price_gross",class:"form-input",type:"text","onUpdate:modelValue":a=>o.total_price_gross=a,disabled:""},null,8,h),[[u,o.total_price_gross]])]),e("div",tt,[e("button",{class:"bg-green-600 font-semibold text-white text-sm px-4 py-2 duration-300 hover:bg-green-700 rounded-full flex justify-center items-center gap-1",onClick:t[8]||(t[8]=v(a=>q(),["prevent"]))}," Nowa pozycja "),e("button",{class:"bg-red-500 font-semibold text-white text-sm px-4 py-2 duration-300 hover:bg-red-600 rounded-full flex justify-center items-center gap-1",onClick:v(a=>l(s).positions.splice(w,1),["prevent"])}," Usuń pozycję ",8,et)])]))),128)),e("div",st,[j(T,{type:"button"},{default:f(()=>t[24]||(t[24]=[c("Wystaw fakturę")])),_:1})])],32)])],64))}});export{ut as default};
